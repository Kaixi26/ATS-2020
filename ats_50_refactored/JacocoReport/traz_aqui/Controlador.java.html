<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Controlador.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ats_50_refactored$All_in_ats_50_refactored.exec</a> &gt; <a href="index.source.html" class="el_package">traz_aqui</a> &gt; <span class="el_source">Controlador.java</span></div><h1>Controlador.java</h1><pre class="source lang-java linenums">package traz_aqui;

import java.io.*;
import java.time.DateTimeException;
import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.ThreadLocalRandom;

public class Controlador {

    private static final String TEXT_LOGIN = &quot;Login&quot;;
    private static final String TEXT_SIGNUP = &quot;Signup&quot;;
    private static final String TEXT_ASKEMAIL = &quot;\nDigite o seu email: \n&quot;;
    private static final String TEXT_ASKPASS = &quot;\nDigite a sua pass: \n&quot;;
    private static final String TEXT_ASKNAME = &quot;\nDigite o seu nome: \n&quot;;
    private static final String TEXT_ASKCOORDS = &quot;\nDigite as suas coordenadas: \n&quot;;
    private static final String TEXT_YESORNO = &quot; ?(y/n)\n&quot;;
    private static final String TEXT_ASKXCOORD = &quot;\&quot;\\nX: \\n\&quot;&quot;;
    private static final String TEXT_ASKYCOORD = &quot;\&quot;\\nY: \\n\&quot;&quot;;
    private static final String TEXT_EMAILINUSE = &quot;\&quot;Erro email em uso no sistema.\&quot;&quot;;
    private static final String TEXT_INCORRECTVALUE = &quot;Valor Incorreto&quot;;
    private static final String TEXT_INCORRECTCREDENTIALS = &quot;\nPassword ou Mail incorreto.&quot;;
    private static final String TEXT_NONCONFIRMEDDELIVERIES = &quot;Encomendas a confirmar:&quot;;
    private static final String TEXT_SEEREGISTERS = &quot;Ver Registos.&quot;;
    private static final String TEXT_SEEAREAEVENTS = &quot;Ver os eventos na sua área.&quot;;

    private Gestor gestor;

<span class="nc" id="L31">    public Controlador() {</span>
<span class="nc" id="L32">        this.gestor = new Gestor();</span>
<span class="nc" id="L33">        this.gestor.loadCat();</span>
<span class="nc" id="L34">        this.gestor.adicionaDef();</span>
<span class="nc" id="L35">    }</span>

    /**
     * Menu principal
     */
    public void menu() {
<span class="nc" id="L41">        List&lt;String&gt; s = new ArrayList&lt;&gt;(Arrays.asList(&quot;Modo User.&quot;, &quot;Modo Voluntário.&quot;, &quot;Modo Transportadora.&quot;, &quot;Modo Loja.&quot;, &quot;Os dez utilizadores que mais usam o sistema.&quot;, &quot;As dez empresas que mais usam o sistema.&quot;, &quot;Guardar e Ler estado.&quot;));</span>
<span class="nc" id="L42">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L45">            m.executa();</span>
<span class="nc" id="L46">            op = m.opcao();</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">            if (op == 1) modoUser();</span>
<span class="nc bnc" id="L48" title="All 2 branches missed.">            else if (op == 2) modoVoluntario();</span>
<span class="nc bnc" id="L49" title="All 2 branches missed.">            else if (op == 3) modoEmpresa();</span>
<span class="nc bnc" id="L50" title="All 2 branches missed.">            else if (op == 4) modoLoja();</span>
<span class="nc bnc" id="L51" title="All 2 branches missed.">            else if (op == 5) topUsers();</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">            else if (op == 6) topTransp();</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">            else if (op == 7) lerGuardar();</span>
<span class="nc bnc" id="L54" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L55">        Viewer.prints(&quot;Goodbye&quot;);</span>

<span class="nc" id="L57">    }</span>

    /**
     * Método que faz print dos topUsers (case 5 do menu principal)
     */
    public void topUsers() {
<span class="nc bnc" id="L63" title="All 2 branches missed.">        for (TopUsers t : this.gestor.topUsers()) Viewer.prints(t);</span>
<span class="nc" id="L64">    }</span>

    /**
     * Método que faz print dos topTransp (case 6 do menu principal)
     */
    public void topTransp() {
<span class="nc" id="L70">        List&lt;TopUsers&gt; top = this.gestor.topTransp();</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">        if (top.isEmpty())</span>
<span class="nc" id="L72">            Viewer.prints(&quot;Nao há condições para realizar o pedido.&quot;);</span>
<span class="nc bnc" id="L73" title="All 2 branches missed.">        else for (TopUsers t : top) Viewer.prints(&quot;Driver: &quot; + t.getCod() + &quot; KmsPerc: &quot; + t.getQnt());</span>
<span class="nc" id="L74">    }</span>

    /**
     * Método que pede ao utilizador o ficheiro que quer utilizar e chama o menu de guardar e ler objecto (case 7 do menu principal)
     */
    public void lerGuardar() {
<span class="nc" id="L80">        Viewer.prints(&quot;Nome do ficheiro que quer usar:\n&quot;);</span>
<span class="nc" id="L81">        String fich = Input.lerString();</span>
<span class="nc" id="L82">        menuObjStream(fich);</span>
<span class="nc" id="L83">    }</span>

    /**
     * Menu que nos permite fazer a escolha entre gravar e ler estado
     *
     * @param str Nome Ficheiro
     */
    public void menuObjStream(String str) {
<span class="nc" id="L91">        List&lt;String&gt; s = new ArrayList&lt;&gt;(Arrays.asList(&quot;Gravar&quot;, &quot;Ler&quot;));</span>
<span class="nc" id="L92">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L95">            m.executa();</span>
<span class="nc" id="L96">            op = m.opcao();</span>
<span class="nc bnc" id="L97" title="All 3 branches missed.">            switch (op) {</span>
                case 1:
                    try {
<span class="nc" id="L100">                        writeEstado(str);</span>
<span class="nc" id="L101">                    } catch (IOException e) {</span>
<span class="nc" id="L102">                        e.printStackTrace();</span>
<span class="nc" id="L103">                        Viewer.prints(&quot;Não foi possível gravar&quot;);</span>
<span class="nc" id="L104">                    }</span>
<span class="nc" id="L105">                    break;</span>
                case 2:
                    try {
<span class="nc" id="L108">                        this.gestor = loadEstado(str);</span>
<span class="nc" id="L109">                    } catch (IOException e) {</span>
<span class="nc" id="L110">                        Viewer.prints(&quot;Não foi possível ler&quot;);</span>
<span class="nc" id="L111">                    } catch (ClassNotFoundException | ClassCastException e) {</span>
<span class="nc" id="L112">                        Viewer.prints(&quot;Erro&quot;);</span>
<span class="nc" id="L113">                    }</span>
<span class="nc" id="L114">                    break;</span>
                default:
            }
<span class="nc bnc" id="L117" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L118">        menu();</span>
<span class="nc" id="L119">    }</span>

    /**
     * Menu do modo utilizador que permite fazer login ou sign up de um utilizador
     */
    public void modoUser() {
<span class="nc" id="L125">        List s = new ArrayList&lt;&gt;(Arrays.asList(TEXT_LOGIN, TEXT_SIGNUP));</span>
<span class="nc" id="L126">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L129">            m.executa();</span>
<span class="nc" id="L130">            op = m.opcao();</span>
<span class="nc bnc" id="L131" title="All 3 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L133">                    loginUser();</span>
<span class="nc" id="L134">                    break;</span>
                case 2:
<span class="nc" id="L136">                    signupUser();</span>
<span class="nc" id="L137">                    break;</span>
                default:
            }
<span class="nc bnc" id="L140" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L141">    }</span>

    /**
     * Menu do modo empresa que permite fazer login ou sign up de uma Transportadora
     */
    public void modoEmpresa() {
<span class="nc" id="L147">        List s = new ArrayList&lt;&gt;(Arrays.asList(TEXT_LOGIN, TEXT_SIGNUP));</span>
<span class="nc" id="L148">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L151">            m.executa();</span>
<span class="nc" id="L152">            op = m.opcao();</span>
<span class="nc bnc" id="L153" title="All 3 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L155">                    loginEmpresa();</span>
<span class="nc" id="L156">                    break;</span>
                case 2:
<span class="nc" id="L158">                    signupEmpresa();</span>
<span class="nc" id="L159">                    break;</span>
                default:
            }
<span class="nc bnc" id="L162" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L163">    }</span>

    /**
     * Menu do modo voluntário que permite fazer login ou sign up de um voluntário
     */
    public void modoVoluntario() {
<span class="nc" id="L169">        List s = new ArrayList&lt;&gt;(Arrays.asList(TEXT_LOGIN, TEXT_SIGNUP));</span>
<span class="nc" id="L170">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L173">            m.executa();</span>
<span class="nc" id="L174">            op = m.opcao();</span>
<span class="nc bnc" id="L175" title="All 3 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L177">                    loginVoluntario();</span>
<span class="nc" id="L178">                    break;</span>
                case 2:
<span class="nc" id="L180">                    signupVoluntario();</span>
<span class="nc" id="L181">                    break;</span>
                default:
            }
<span class="nc bnc" id="L184" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L185">    }</span>

    /**
     * Menu do modo loja que permite fazer login ou sign up de uma Loja
     */
    public void modoLoja() {
<span class="nc" id="L191">        List s = new ArrayList&lt;&gt;(Arrays.asList(TEXT_LOGIN, TEXT_SIGNUP));</span>
<span class="nc" id="L192">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L195">            m.executa();</span>
<span class="nc" id="L196">            op = m.opcao();</span>
<span class="nc bnc" id="L197" title="All 3 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L199">                    loginLoja();</span>
<span class="nc" id="L200">                    break;</span>
                case 2:
<span class="nc" id="L202">                    signupLoja();</span>
<span class="nc" id="L203">                    break;</span>
                default:
            }
<span class="nc bnc" id="L206" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L207">    }</span>

    /**
     * Menu do modo login de um utilizador
     */
    public void loginUser() {
<span class="nc" id="L213">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L214">        String email = Input.lerString();</span>
<span class="nc" id="L215">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L216">        String pass = Input.lerString();</span>
<span class="nc" id="L217">        String f = this.gestor.login(1, email, pass);</span>
<span class="nc bnc" id="L218" title="All 2 branches missed.">        if (f != null) alertasU(f);</span>
        else {
<span class="nc" id="L220">            Viewer.prints(TEXT_INCORRECTCREDENTIALS);</span>
<span class="nc" id="L221">            modoUser();</span>
        }
<span class="nc" id="L223">    }</span>

    /**
     * Menu do modo login de uma transportadora
     */
    public void loginEmpresa() {
<span class="nc" id="L229">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L230">        String email = Input.lerString();</span>
<span class="nc" id="L231">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L232">        String pass = Input.lerString();</span>
<span class="nc" id="L233">        String f = this.gestor.login(2, email, pass);</span>
<span class="nc bnc" id="L234" title="All 2 branches missed.">        if (f != null) alertasE(f);</span>
        else {
<span class="nc" id="L236">            Viewer.prints(TEXT_INCORRECTCREDENTIALS);</span>
<span class="nc" id="L237">            modoEmpresa();</span>
        }
<span class="nc" id="L239">    }</span>

    /**
     * Menu do modo login de um voluntário
     */
    public void loginVoluntario() {
<span class="nc" id="L245">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L246">        String email = Input.lerString();</span>
<span class="nc" id="L247">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L248">        String pass = Input.lerString();</span>
<span class="nc" id="L249">        String f = this.gestor.login(3, email, pass);</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">        if (f != null) alertasV(f);</span>
        else {
<span class="nc" id="L252">            Viewer.prints(TEXT_INCORRECTCREDENTIALS);</span>
<span class="nc" id="L253">            modoVoluntario();</span>
        }
<span class="nc" id="L255">    }</span>

    /**
     * Menu do modo login de uma loja
     */
    public void loginLoja() {
<span class="nc" id="L261">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L262">        String email = Input.lerString();</span>
<span class="nc" id="L263">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L264">        String pass = Input.lerString();</span>
<span class="nc" id="L265">        String f = this.gestor.login(4, email, pass);</span>
<span class="nc bnc" id="L266" title="All 2 branches missed.">        if (f != null) menuLoja(f);</span>
        else {
<span class="nc" id="L268">            Viewer.prints(TEXT_INCORRECTCREDENTIALS);</span>
<span class="nc" id="L269">            modoLoja();</span>
        }
<span class="nc" id="L271">    }</span>

    /**
     * Menu do modo sign up de um utilizador
     */
    public void signupUser() {
<span class="nc" id="L277">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L278">        String email = Input.lerString();</span>
<span class="nc" id="L279">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L280">        String pass = Input.lerString();</span>
<span class="nc" id="L281">        Viewer.prints(TEXT_ASKNAME);</span>
<span class="nc" id="L282">        String nome = Input.lerString();</span>
<span class="nc" id="L283">        Viewer.prints(TEXT_ASKCOORDS);</span>
<span class="nc" id="L284">        Viewer.prints(TEXT_ASKXCOORD);</span>
<span class="nc" id="L285">        double x = Input.lerDouble();</span>
<span class="nc" id="L286">        Viewer.prints(TEXT_ASKYCOORD);</span>
<span class="nc" id="L287">        double y = Input.lerDouble();</span>
<span class="nc" id="L288">        String cod = this.gestor.geraCods(2);</span>
<span class="nc bnc" id="L289" title="All 2 branches missed.">        if (this.gestor.verificaMail(1, email)) {</span>
<span class="nc" id="L290">            Viewer.prints(TEXT_EMAILINUSE);</span>
<span class="nc" id="L291">            signupUser();</span>
<span class="nc" id="L292">        } else this.gestor.registarUser(cod, nome, new Coordenadas(x, y), pass, email);</span>
<span class="nc" id="L293">        alertasU(cod);</span>
<span class="nc" id="L294">    }</span>

    /**
     * Menu do modo sign up de uma Transportadora
     */
    public void signupEmpresa() {
<span class="nc" id="L300">        boolean med = false;</span>
<span class="nc" id="L301">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L302">        String email = Input.lerString();</span>
<span class="nc" id="L303">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L304">        String pass = Input.lerString();</span>
<span class="nc" id="L305">        Viewer.prints(TEXT_ASKNAME);</span>
<span class="nc" id="L306">        String nome = Input.lerString();</span>
<span class="nc" id="L307">        Viewer.prints(TEXT_ASKCOORDS);</span>
<span class="nc" id="L308">        Viewer.prints(TEXT_ASKXCOORD);</span>
<span class="nc" id="L309">        double x = Input.lerDouble();</span>
<span class="nc" id="L310">        Viewer.prints(TEXT_ASKYCOORD);</span>
<span class="nc" id="L311">        double y = Input.lerDouble();</span>
<span class="nc" id="L312">        Viewer.prints(&quot;\nDigite o seu range:\n&quot;);</span>
<span class="nc" id="L313">        double range = Input.lerDouble();</span>
<span class="nc" id="L314">        Viewer.prints(&quot;\nDigite o seu preço por km:\n&quot;);</span>
<span class="nc" id="L315">        double prkm = Input.lerDouble();</span>
<span class="nc" id="L316">        Viewer.prints(&quot;\nDigite o seu NIF:\n&quot;);</span>
<span class="nc" id="L317">        double nif = Input.lerDouble();</span>
<span class="nc" id="L318">        Viewer.prints(&quot;\nDigite a sua velocidade:\n&quot;);</span>
<span class="nc" id="L319">        double vkm = Input.lerDouble();</span>
<span class="nc" id="L320">        Viewer.prints(&quot;\nDigite a sua capacidade:\n&quot;);</span>
<span class="nc" id="L321">        int cap = Input.lerInt();</span>
<span class="nc" id="L322">        Viewer.prints(&quot;\nTem competências de transporte médico?(y/n):\n&quot;);</span>
<span class="nc" id="L323">        String pri = Input.lerString();</span>
<span class="nc bnc" id="L324" title="All 4 branches missed.">        if (pri.equals(&quot;y&quot;) || pri.equals(&quot;Y&quot;)) med = true;</span>
        else {
<span class="nc" id="L326">            Viewer.prints(TEXT_INCORRECTVALUE);</span>
<span class="nc" id="L327">            signupEmpresa();</span>
        }
<span class="nc" id="L329">        String cod = this.gestor.geraCods(1);</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">        if (this.gestor.verificaMail(2, email)) {</span>
<span class="nc" id="L331">            Viewer.prints(TEXT_EMAILINUSE);</span>
<span class="nc" id="L332">            signupEmpresa();</span>
        } else
<span class="nc" id="L334">            this.gestor.registarEmpresa(cod, nome, new Coordenadas(x, y), range, prkm, nif, -1, med, vkm, email, pass, 0, cap);</span>
<span class="nc" id="L335">        alertasE(cod);</span>
<span class="nc" id="L336">    }</span>

    /**
     * Menu do modo sign up de um voluntário
     */
    public void signupVoluntario() {
<span class="nc" id="L342">        boolean med = false;</span>
<span class="nc" id="L343">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L344">        String email = Input.lerString();</span>
<span class="nc" id="L345">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L346">        String pass = Input.lerString();</span>
<span class="nc" id="L347">        Viewer.prints(TEXT_ASKNAME);</span>
<span class="nc" id="L348">        String nome = Input.lerString();</span>
<span class="nc" id="L349">        Viewer.prints(TEXT_ASKCOORDS);</span>
<span class="nc" id="L350">        Viewer.prints(TEXT_ASKXCOORD);</span>
<span class="nc" id="L351">        double x = Input.lerDouble();</span>
<span class="nc" id="L352">        Viewer.prints(TEXT_ASKYCOORD);</span>
<span class="nc" id="L353">        double y = Input.lerDouble();</span>
<span class="nc" id="L354">        Viewer.prints(&quot;\nDigite o seu range:\n&quot;);</span>
<span class="nc" id="L355">        double range = Input.lerDouble();</span>
<span class="nc" id="L356">        Viewer.prints(&quot;\nDigite a sua velocidade:\n&quot;);</span>
<span class="nc" id="L357">        double vkm = Input.lerDouble();</span>
<span class="nc" id="L358">        Viewer.prints(&quot;\nTem compretências de transporte médico?(y/n):\n&quot;);</span>
<span class="nc" id="L359">        String pri = Input.lerString();</span>
<span class="nc bnc" id="L360" title="All 4 branches missed.">        if (pri.equals(&quot;y&quot;) || pri.equals(&quot;Y&quot;)) med = true;</span>
        else {
<span class="nc" id="L362">            Viewer.prints(TEXT_INCORRECTVALUE);</span>
<span class="nc" id="L363">            signupVoluntario();</span>
        }
<span class="nc" id="L365">        String cod = this.gestor.geraCods(3);</span>
<span class="nc bnc" id="L366" title="All 2 branches missed.">        if (this.gestor.verificaMail(3, email)) {</span>
<span class="nc" id="L367">            Viewer.prints(TEXT_EMAILINUSE);</span>
<span class="nc" id="L368">            signupVoluntario();</span>
<span class="nc" id="L369">        } else this.gestor.registarVoluntario(cod, nome, range, new Coordenadas(x, y), -1, med, vkm, email, pass, 1);</span>
<span class="nc" id="L370">        alertasV(cod);</span>
<span class="nc" id="L371">    }</span>

    /**
     * Menu do modo sign up de uma Loja
     */
    public void signupLoja() {
<span class="nc" id="L377">        int fila = -1;</span>
<span class="nc" id="L378">        Viewer.prints(TEXT_ASKEMAIL);</span>
<span class="nc" id="L379">        String email = Input.lerString();</span>
<span class="nc" id="L380">        Viewer.prints(TEXT_ASKPASS);</span>
<span class="nc" id="L381">        String pass = Input.lerString();</span>
<span class="nc" id="L382">        Viewer.prints(TEXT_ASKNAME);</span>
<span class="nc" id="L383">        String nome = Input.lerString();</span>
<span class="nc" id="L384">        Viewer.prints(TEXT_ASKCOORDS);</span>
<span class="nc" id="L385">        Viewer.prints(TEXT_ASKXCOORD);</span>
<span class="nc" id="L386">        double x = Input.lerDouble();</span>
<span class="nc" id="L387">        Viewer.prints(TEXT_ASKYCOORD);</span>
<span class="nc" id="L388">        double y = Input.lerDouble();</span>
<span class="nc" id="L389">        String cod = this.gestor.geraCods(4);</span>
<span class="nc" id="L390">        Viewer.prints(&quot;\nSabe o tamanho médio da sua fila (y/n): \n&quot;);</span>
<span class="nc" id="L391">        String fil = Input.lerString();</span>
<span class="nc bnc" id="L392" title="All 4 branches missed.">        if (fil.equals(&quot;y&quot;) || fil.equals(&quot;Y&quot;)) {</span>
<span class="nc" id="L393">            Viewer.prints(&quot;\nTamanho da fila: \n&quot;);</span>
<span class="nc" id="L394">            fila = Input.lerInt();</span>
<span class="nc bnc" id="L395" title="All 4 branches missed.">        } else if (fil.equals(&quot;n&quot;) || fil.equals(&quot;N&quot;)) fila = -1;</span>
        else {
<span class="nc" id="L397">            Viewer.prints(TEXT_INCORRECTVALUE);</span>
<span class="nc" id="L398">            signupLoja();</span>
        }

<span class="nc bnc" id="L401" title="All 2 branches missed.">        if (this.gestor.verificaMail(4, email)) {</span>
<span class="nc" id="L402">            Viewer.prints(TEXT_EMAILINUSE);</span>
<span class="nc" id="L403">            signupLoja();</span>
<span class="nc" id="L404">        } else this.gestor.registarLoja(cod, nome, new Coordenadas(x, y), fila, email, pass);</span>
<span class="nc" id="L405">        menuLoja(cod);</span>
<span class="nc" id="L406">    }</span>

    /**
     * Menu de todos os alertas que possam ser feitos ao modo utilizador desde confirmação de encomendas, transporte e classificações
     *
     * @param cod Código Utilizador
     */
    public void alertasU(String cod) {
<span class="nc" id="L414">        int i = 1;</span>
<span class="nc" id="L415">        List&lt;Registos&gt; a = this.gestor.histReg(cod, 1);</span>
<span class="nc bnc" id="L416" title="All 2 branches missed.">        if (!a.isEmpty()) {</span>
<span class="nc" id="L417">            Viewer.prints(TEXT_NONCONFIRMEDDELIVERIES);</span>
<span class="nc bnc" id="L418" title="All 2 branches missed.">            for (Registos r : a) {</span>
<span class="nc bnc" id="L419" title="All 2 branches missed.">                if (r.getDriver().charAt(0) == 't')</span>
<span class="nc" id="L420">                    Viewer.prints((i) + &quot;) &quot; + &quot;Transportadora: &quot; + r.getDriver() + &quot; Custo de Transporte previsto: &quot; + r.getCustoT() + &quot; Tempo de encomenda previsto: &quot; + r.getTmp());</span>
<span class="nc bnc" id="L421" title="All 2 branches missed.">                if (r.getDriver().charAt(0) == 'v')</span>
<span class="nc" id="L422">                    Viewer.prints((i) + &quot;) &quot; + &quot;Voluntario: &quot; + r.getDriver() + &quot; Custo de Transporte previsto: &quot; + r.getCustoT() + &quot; Tempo de encomenda previsto: &quot; + r.getTmp());</span>
<span class="nc" id="L423">                i++;</span>
<span class="nc" id="L424">            }</span>
<span class="nc bnc" id="L425" title="All 2 branches missed.">            for (i = 0; i &lt; a.size(); i++) {</span>
<span class="nc" id="L426">                Viewer.prints(&quot;Pretende aceitar o transporte &quot; + (i + 1) + TEXT_YESORNO);</span>
<span class="nc" id="L427">                String res = Input.lerString();</span>
<span class="nc" id="L428">                this.gestor.aumCap(a.get(i).getDriver());</span>
<span class="nc bnc" id="L429" title="All 4 branches missed.">                if (res.equals(&quot;y&quot;) || res.equals(&quot;Y&quot;))</span>
<span class="nc" id="L430">                    this.gestor.getItDone(a.get(i).getEnc().getCod(), a.get(i).getLoja(), a.get(i).getUser(), a.get(i).getDriver(), a.get(i).getTmp());</span>
<span class="nc bnc" id="L431" title="All 4 branches missed.">                else if (res.equals(&quot;n&quot;) || res.equals(&quot;N&quot;)) this.gestor.declinedT(a.get(0));</span>
<span class="nc" id="L432">                else alertasU(cod);</span>
            }
        }
<span class="nc" id="L435">        List&lt;Registos&gt; g = this.gestor.histReg(cod, 3);</span>
<span class="nc" id="L436">        i = 1;</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">        if (!g.isEmpty()) {</span>
<span class="nc" id="L438">            Viewer.prints(&quot;Entregas a classificar&quot;);</span>
<span class="nc bnc" id="L439" title="All 2 branches missed.">            for (Registos f : g) {</span>
<span class="nc bnc" id="L440" title="All 2 branches missed.">                if (f.getDriver().charAt(0) == 't')</span>
<span class="nc" id="L441">                    Viewer.prints((i) + &quot;) &quot; + &quot;Transportadora: &quot; + f.getDriver() + &quot; Custo de encomenda: &quot; + (f.getEnc().custo() + f.getCustoT()));</span>
<span class="nc bnc" id="L442" title="All 2 branches missed.">                if (f.getDriver().charAt(0) == 'v')</span>
<span class="nc" id="L443">                    Viewer.prints((i) + &quot;) &quot; + &quot;Voluntario: &quot; + f.getDriver() + &quot; Custo de encomenda: &quot; + (f.getEnc().custo() + f.getCustoT()));</span>
<span class="nc" id="L444">                i++;</span>
<span class="nc" id="L445">            }</span>
<span class="nc bnc" id="L446" title="All 2 branches missed.">            for (i = 0; i &lt; g.size(); i++) {</span>
<span class="nc" id="L447">                Viewer.prints(&quot;Como classifica a entrega &quot; + (i + 1) + &quot; de (1 a 10):&quot;);</span>
<span class="nc" id="L448">                double clas = Input.lerDouble();</span>
<span class="nc bnc" id="L449" title="All 4 branches missed.">                if (clas &lt; 0 || clas &gt; 10) alertasU(cod);</span>
<span class="nc" id="L450">                else this.gestor.classifica(g.get(i), clas);</span>
            }
        }
<span class="nc" id="L453">        menuUser(cod);</span>
<span class="nc" id="L454">    }</span>

    /**
     * Menu de todos os alertas que possam ser feitos ao modo transportadora como confirmação de encomenda
     *
     * @param cod Código Transportadora
     */
    public void alertasE(String cod) {
<span class="nc" id="L462">        int i = 1;</span>
<span class="nc" id="L463">        List&lt;Registos&gt; a = this.gestor.histReg(cod, 4);</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">        if (!a.isEmpty()) {</span>
<span class="nc" id="L465">            Viewer.prints(TEXT_NONCONFIRMEDDELIVERIES);</span>
<span class="nc bnc" id="L466" title="All 2 branches missed.">            for (Registos r : a) {</span>
<span class="nc" id="L467">                Viewer.prints((i) + &quot;) &quot; + &quot;User: &quot; + r.getUser() + &quot; - &quot; + r.getEnc());</span>
<span class="nc" id="L468">                i++;</span>
<span class="nc" id="L469">            }</span>
<span class="nc" id="L470">            gestorViewerE(cod, a);</span>
        }
<span class="nc" id="L472">        menuEmpresa(cod);</span>
<span class="nc" id="L473">    }</span>

    private void gestorViewerE(String cod, List&lt;Registos&gt; a) {
        int i;
<span class="nc bnc" id="L477" title="All 2 branches missed.">        for (i = 0; i &lt; a.size(); i++) {</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">            if (this.gestor.getCap(cod) == 0) {</span>
<span class="nc" id="L479">                Viewer.prints((i + 1) + &quot; - Não tem capacidade para realizar a encomenda\n&quot;);</span>
<span class="nc" id="L480">                this.gestor.declinedT(a.get(i));</span>
            } else {
<span class="nc" id="L482">                Viewer.prints(&quot;Pretende aceitar a encomenda &quot; + (i + 1) + TEXT_YESORNO);</span>
<span class="nc" id="L483">                String res = Input.lerString();</span>
<span class="nc bnc" id="L484" title="All 4 branches missed.">                if (res.equals(&quot;y&quot;) || res.equals(&quot;Y&quot;)) {</span>
<span class="nc" id="L485">                    this.gestor.avanca(a.get(i));</span>
<span class="nc" id="L486">                    this.gestor.dimCap(cod);</span>
<span class="nc bnc" id="L487" title="All 4 branches missed.">                } else if (res.equals(&quot;n&quot;) || res.equals(&quot;N&quot;)) this.gestor.declinedT(a.get(i));</span>
<span class="nc" id="L488">                else alertasE(cod);</span>
            }
        }
<span class="nc" id="L491">    }</span>

    /**
     * Menu de todos os alertas que possam ser feitos ao modo voluntário como confirmação de encomenda
     *
     * @param cod Código Voluntário
     */
    public void alertasV(String cod) {
<span class="nc" id="L499">        int i = 1;</span>
<span class="nc" id="L500">        List&lt;Registos&gt; a = this.gestor.histReg(cod, 4);</span>
<span class="nc bnc" id="L501" title="All 2 branches missed.">        if (!a.isEmpty()) {</span>
<span class="nc" id="L502">            Viewer.prints(TEXT_NONCONFIRMEDDELIVERIES);</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">            for (Registos r : a) {</span>
<span class="nc" id="L504">                Viewer.prints((i) + &quot;) &quot; + &quot;User: &quot; + r.getUser() + &quot; - &quot; + r.getEnc());</span>
<span class="nc" id="L505">                i++;</span>
<span class="nc" id="L506">            }</span>
<span class="nc bnc" id="L507" title="All 2 branches missed.">            for (i = 0; i &lt; a.size(); i++) {</span>
<span class="nc bnc" id="L508" title="All 2 branches missed.">                if (this.gestor.getCap(cod) == 0) {</span>
<span class="nc" id="L509">                    Viewer.prints((i + 1) + &quot; - Não tem capacidade para realizar a encomenda\n&quot;);</span>
<span class="nc" id="L510">                    this.gestor.declinedT(a.get(i));</span>
                } else {
<span class="nc" id="L512">                    Viewer.prints(&quot;Pretende aceitar a encomenda &quot; + (i + 1) + TEXT_YESORNO);</span>
<span class="nc" id="L513">                    String res = Input.lerString();</span>
<span class="nc bnc" id="L514" title="All 4 branches missed.">                    if (res.equals(&quot;y&quot;) || res.equals(&quot;Y&quot;)) {</span>
<span class="nc" id="L515">                        this.gestor.avanca(a.get(i));</span>
<span class="nc" id="L516">                        this.gestor.dimCap(cod);</span>
<span class="nc bnc" id="L517" title="All 4 branches missed.">                    } else if (res.equals(&quot;n&quot;) || res.equals(&quot;N&quot;)) this.gestor.declinedT(a.get(i));</span>
<span class="nc" id="L518">                    else alertasV(cod);</span>
                }
            }
        }
<span class="nc" id="L522">        menuVoluntario(cod);</span>
<span class="nc" id="L523">    }</span>

    /**
     * Menu de Utilizador, são dadas as opcões de fazer uma encomenda, ver os registos e ver eventos
     *
     * @param cod Código Utilizador
     */
    public void menuUser(String cod) {
<span class="nc" id="L531">        Viewer.prints(&quot;\nUtilizador: &quot; + cod + &quot;.&quot;);</span>
<span class="nc" id="L532">        Utilizador u = this.gestor.procUtil(cod);</span>
<span class="nc" id="L533">        List s = new ArrayList&lt;&gt;(Arrays.asList(&quot;Fazer Encomenda.&quot;, TEXT_SEEREGISTERS, TEXT_SEEAREAEVENTS));</span>
<span class="nc" id="L534">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L537">            m.executa();</span>
<span class="nc" id="L538">            op = m.opcao();</span>
<span class="nc bnc" id="L539" title="All 4 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L541">                    fazerEncomenda(u.getCord(), u.getNome(), cod);</span>
<span class="nc" id="L542">                    break;</span>
                case 2:
<span class="nc" id="L544">                    verRegistos(cod);</span>
<span class="nc" id="L545">                    break;</span>
                case 3:
<span class="nc" id="L547">                    verEventos(u.getCord());</span>
<span class="nc" id="L548">                    break;</span>
                default:
                    break;
            }
<span class="nc bnc" id="L552" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L553">    }</span>

    /**
     * Método que cria uma nova encomenda se assim for possível
     *
     * @param a    Coordenadas
     * @param nome Nome Utilizador
     * @param cod  Código
     */
    public void fazerEncomenda(Coordenadas a, String nome, String cod) {
<span class="nc" id="L563">        int i = 0;</span>
<span class="nc" id="L564">        int f = 1;</span>
<span class="nc" id="L565">        boolean still = true;</span>
<span class="nc" id="L566">        boolean pr = false;</span>
<span class="nc" id="L567">        Viewer.prints(&quot;\nA que distância máxima de uma loja (em km) pretende procurar?\n&quot;);</span>
<span class="nc" id="L568">        int dist = Input.lerInt();</span>
<span class="nc" id="L569">        Viewer.prints(&quot;\nLojas a &quot; + dist + &quot; km de si:\n&quot;);</span>
<span class="nc" id="L570">        List&lt;Loja&gt; lojas = this.gestor.getLojasinRange(a, dist);</span>
<span class="nc bnc" id="L571" title="All 2 branches missed.">        if (lojas.isEmpty()) {</span>
<span class="nc" id="L572">            Viewer.prints(&quot;Nehuma loja encontrada em range.&quot;);</span>
<span class="nc" id="L573">            menuUser(cod);</span>
        }
<span class="nc bnc" id="L575" title="All 2 branches missed.">        for (Loja g : lojas) {</span>
<span class="nc" id="L576">            Viewer.prints(f + &quot;) &quot; + g.getNome());</span>
<span class="nc" id="L577">            f++;</span>
<span class="nc" id="L578">        }</span>
<span class="nc" id="L579">        Viewer.prints(&quot;\nDe qual loja pretende encomendar (use o index)?\n&quot;);</span>
<span class="nc" id="L580">        int ind = Input.lerInt();</span>
<span class="nc" id="L581">        Encomenda enc = new Encomenda(this.gestor.geraCods(0), nome, lojas.get(ind - 1).getCod(), 0);</span>
<span class="nc bnc" id="L582" title="All 2 branches missed.">        while (still) {</span>
<span class="nc" id="L583">            Viewer.prints(&quot;\nPretende comprar um produto de prioridade? (y/n)\n&quot;);</span>
<span class="nc" id="L584">            String pri = Input.lerString();</span>
<span class="nc bnc" id="L585" title="All 4 branches missed.">            if (pri.equals(&quot;y&quot;) || pri.equals(&quot;Y&quot;)) pr = true;</span>
<span class="nc bnc" id="L586" title="All 4 branches missed.">            else if (pri.equals(&quot;n&quot;) || pri.equals(&quot;N&quot;)) pr = false;</span>
<span class="nc" id="L587">            else fazerEncomenda(a, nome, cod);</span>
<span class="nc" id="L588">            Viewer.prints(&quot;\nQual produto pretende comprar?\n&quot;);</span>
<span class="nc" id="L589">            String prod = Input.lerString();</span>
<span class="nc" id="L590">            Viewer.prints(&quot;\nQual quantidade quer comprar?\n&quot;);</span>
<span class="nc" id="L591">            double qnt = Input.lerDouble();</span>
<span class="nc" id="L592">            enc.adicionaLEnco(new LinhaEncomenda(Integer.toString(i), prod, qnt, ThreadLocalRandom.current().nextDouble(1, 999)));</span>
<span class="nc" id="L593">            i++;</span>
<span class="nc" id="L594">            enc.setPeso(enc.getPeso() + qnt);</span>
<span class="nc" id="L595">            Viewer.prints(&quot;\nQuer realizar mais compras? (y/n)\n&quot;);</span>
<span class="nc" id="L596">            String ts = Input.lerString();</span>
<span class="nc bnc" id="L597" title="All 4 branches missed.">            if (ts.equals(&quot;n&quot;) || ts.equals(&quot;N&quot;)) still = false;</span>
<span class="nc" id="L598">        }</span>
<span class="nc" id="L599">        List&lt;StringDistAux&gt; m = this.gestor.getBestLoja(lojas.get(ind - 1).getCord(), a, pr);</span>
<span class="nc bnc" id="L600" title="All 2 branches missed.">        if (m.isEmpty()) Viewer.prints(&quot;Não é possivel realizar a encomenda (não existe meios de transporte)&quot;);</span>
        else {
<span class="nc" id="L602">            this.gestor.gestaoEncomenda(enc, cod, m);</span>
<span class="nc" id="L603">            this.gestor.registarEnc(enc);</span>
<span class="nc" id="L604">            Viewer.prints(&quot;Custo de encomenda (antes de transportes): &quot; + enc.custo());</span>
        }
<span class="nc" id="L606">        menuUser(cod);</span>
<span class="nc" id="L607">    }</span>

    /**
     * Menu de Empresa, são dadas as opcões de ver registos, classificações, eventos e total facturado num intervalo
     *
     * @param cod Código Transportadora
     */
    public void menuEmpresa(String cod) {
<span class="nc" id="L615">        Viewer.prints(&quot;\nTransportadora: &quot; + cod + &quot;.&quot;);</span>
<span class="nc" id="L616">        List s = new ArrayList&lt;&gt;(Arrays.asList(TEXT_SEEREGISTERS, &quot;Ver Classificação.&quot;, TEXT_SEEAREAEVENTS, &quot;Ver total facturado num período de tempo.&quot;));</span>
<span class="nc" id="L617">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L620">            m.executa();</span>
<span class="nc" id="L621">            op = m.opcao();</span>
<span class="nc bnc" id="L622" title="All 5 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L624">                    verRegistos(cod);</span>
<span class="nc" id="L625">                    break;</span>
                case 2:
<span class="nc" id="L627">                    verClas(cod);</span>
<span class="nc" id="L628">                    break;</span>
                case 3:
<span class="nc" id="L630">                    verEventos(this.gestor.getCoord(cod));</span>
<span class="nc" id="L631">                    break;</span>
                case 4:
<span class="nc" id="L633">                    factTempo(cod);</span>
<span class="nc" id="L634">                    break;</span>
                default:
                    break;
            }
<span class="nc bnc" id="L638" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L639">    }</span>

    /**
     * Menu de Voluntário, são dadas as opcões ver os registos,eventos e classificação
     *
     * @param cod Código Voluntário
     */
    public void menuVoluntario(String cod) {
<span class="nc" id="L647">        Viewer.prints(&quot;\nVoluntário: &quot; + cod + &quot;.&quot;);</span>
<span class="nc" id="L648">        List s = new ArrayList&lt;&gt;(Arrays.asList(TEXT_SEEREGISTERS, &quot;Ver Classificação.&quot;, TEXT_SEEAREAEVENTS));</span>
<span class="nc" id="L649">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L652">            m.executa();</span>
<span class="nc" id="L653">            op = m.opcao();</span>
<span class="nc bnc" id="L654" title="All 4 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L656">                    verRegistos(cod);</span>
<span class="nc" id="L657">                    break;</span>
                case 2:
<span class="nc" id="L659">                    verClas(cod);</span>
<span class="nc" id="L660">                    break;</span>
                case 3:
<span class="nc" id="L662">                    verEventos(this.gestor.getCoord(cod));</span>
<span class="nc" id="L663">                    break;</span>
                default:
                    break;
            }
<span class="nc bnc" id="L667" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L668">    }</span>

    /**
     * Menu de Loja, são dadas as opcões ver os registos e eventos
     *
     * @param cod Código Loja
     */
    public void menuLoja(String cod) {
<span class="nc" id="L676">        Viewer.prints(&quot;\nLoja: &quot; + cod + &quot;.&quot;);</span>
<span class="nc" id="L677">        List s = new ArrayList&lt;&gt;(Arrays.asList(TEXT_SEEREGISTERS, TEXT_SEEAREAEVENTS));</span>
<span class="nc" id="L678">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L681">            m.executa();</span>
<span class="nc" id="L682">            op = m.opcao();</span>
<span class="nc bnc" id="L683" title="All 3 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L685">                    verRegistos(cod);</span>
<span class="nc" id="L686">                    break;</span>
                case 2:
<span class="nc" id="L688">                    verEventos(this.gestor.getCoord(cod));</span>
<span class="nc" id="L689">                    break;</span>
                default:
                    break;
            }
<span class="nc bnc" id="L693" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L694">    }</span>

    /**
     * Menu de Registos com a possibilidade de se ver as listas dos diferentes estados de Registos
     *
     * @param cod Código
     */
    public void verRegistos(String cod) {
<span class="nc" id="L702">        Viewer.prints(&quot;Qual histórico de encomendas pretende ver?&quot;);</span>
<span class="nc" id="L703">        List s = new ArrayList&lt;&gt;(Arrays.asList(&quot;Received.&quot;, &quot;Terminated.&quot;, &quot;Accepted.&quot;, &quot;Pending.&quot;, &quot;Finalized&quot;));</span>
<span class="nc" id="L704">        Menu m = new Menu(s);</span>
        int op;
        do {
<span class="nc" id="L707">            m.executa();</span>
<span class="nc" id="L708">            op = m.opcao();</span>
<span class="nc bnc" id="L709" title="All 6 branches missed.">            switch (op) {</span>
                case 1:
<span class="nc" id="L711">                    history(cod, 3);</span>
<span class="nc" id="L712">                    break;</span>
                case 2:
<span class="nc" id="L714">                    history(cod, 2);</span>
<span class="nc" id="L715">                    break;</span>
                case 3:
<span class="nc" id="L717">                    history(cod, 1);</span>
<span class="nc" id="L718">                    break;</span>
                case 4:
<span class="nc" id="L720">                    history(cod, 4);</span>
<span class="nc" id="L721">                    break;</span>
                case 5:
<span class="nc" id="L723">                    history(cod, 5);</span>
<span class="nc" id="L724">                    break;</span>
                default:
                    break;
            }
<span class="nc bnc" id="L728" title="All 2 branches missed.">        } while (op != 0);</span>
<span class="nc" id="L729">    }</span>

    /**
     * Método que possibilita vermos o histórico de um utilizador, voluntário, empresa, loja no modo que desejarmos
     *
     * @param cod  Código
     * @param modo Modo
     */
    public void history(String cod, int modo) {
        int i;
<span class="nc" id="L739">        List&lt;Registos&gt; a = this.gestor.histReg(cod, modo);</span>
<span class="nc bnc" id="L740" title="All 2 branches missed.">        if (a.isEmpty()) Viewer.prints(&quot;Não existem elementos no histórico.&quot;);</span>
        else {
<span class="nc bnc" id="L742" title="All 4 branches missed.">            if (modo == 3 || modo == 5)</span>
<span class="nc" id="L743">                a.forEach(x -&gt; Viewer.prints(x.getData() + &quot; - User: &quot; + x.getUser() + &quot; - Driver: &quot; + x.getDriver() + &quot; - Tempo: &quot; + x.getTmp() + &quot; - Custo: &quot; + (x.getEnc().custo() + x.getCustoT()) + &quot; - Enc: &quot; + x.getEnc() + &quot; - Custo transporte: &quot; + x.getCustoT()));</span>
<span class="nc" id="L744">            else a.forEach(x -&gt; Viewer.prints(x.getData() + &quot; - User: &quot; + x.getUser() + &quot; - Driver: &quot; + x.getDriver()));</span>
        }
<span class="nc" id="L746">        Viewer.prints(&quot;\n0) Voltar aos registos.&quot;);</span>
        do {
<span class="nc" id="L748">            i = Input.lerInt();</span>
<span class="nc bnc" id="L749" title="All 2 branches missed.">        } while (i != 0);</span>
<span class="nc" id="L750">        verRegistos(cod);</span>
<span class="nc" id="L751">    }</span>

    /**
     * Método que apresenta a classificação de uma transportadora ou voluntário dependendo do código dado
     *
     * @param cod Código Driver
     */
    public void verClas(String cod) {
<span class="nc" id="L759">        double i = this.gestor.getClas(cod);</span>
<span class="nc bnc" id="L760" title="All 2 branches missed.">        if (i == -1) Viewer.prints(&quot;Não classificado&quot;);</span>
<span class="nc" id="L761">        else Viewer.prints(&quot;Classificação acumulada: &quot; + i);</span>
<span class="nc" id="L762">        Viewer.prints(&quot;\n0) Voltar ao Menu.&quot;);</span>
        do {
<span class="nc" id="L764">            i = Input.lerInt();</span>
<span class="nc bnc" id="L765" title="All 2 branches missed.">        } while (i != 0);</span>
<span class="nc" id="L766">    }</span>

    /**
     * Método que apresenta todos os eventos que possam afetar o tempo de envio numa área
     *
     * @param c Coordenadas
     */
    public void verEventos(Coordenadas c) {
        int i;
<span class="nc" id="L775">        Viewer.prints(&quot;Eventos que possam afetar o tempo de envio (1-100)(melhor-pior): &quot;);</span>
<span class="nc" id="L776">        Viewer.prints(&quot;\nClima na sua área: &quot; + this.gestor.getRando(c, 0));</span>
<span class="nc" id="L777">        Viewer.prints(&quot;Trânsito na sua área: &quot; + this.gestor.getRando(c, 1));</span>
<span class="nc" id="L778">        Viewer.prints(&quot;\n0) Voltar ao menu.&quot;);</span>
        do {
<span class="nc" id="L780">            i = Input.lerInt();</span>
<span class="nc bnc" id="L781" title="All 2 branches missed.">        } while (i != 0);</span>
<span class="nc" id="L782">    }</span>

    /**
     * Método que mostra a facturação total num intervalo
     *
     * @param cod Código Empresa
     */
    public void factTempo(String cod) {
        int i;
<span class="nc" id="L791">        Viewer.prints(&quot;Insira o periodo de tempo inicial&quot;);</span>
<span class="nc" id="L792">        Viewer.prints(&quot;Ano:&quot;);</span>
<span class="nc" id="L793">        int anoI = Input.lerInt();</span>
<span class="nc" id="L794">        Viewer.prints(&quot;Dia:&quot;);</span>
<span class="nc" id="L795">        int diaI = Input.lerInt();</span>
<span class="nc" id="L796">        Viewer.prints(&quot;Mes:&quot;);</span>
<span class="nc" id="L797">        int mesI = Input.lerInt();</span>
<span class="nc" id="L798">        Viewer.prints(&quot;Horas:&quot;);</span>
<span class="nc" id="L799">        int horasI = Input.lerInt();</span>
<span class="nc" id="L800">        Viewer.prints(&quot;Minuto:&quot;);</span>
<span class="nc" id="L801">        int minI = Input.lerInt();</span>
<span class="nc" id="L802">        Viewer.prints(&quot;Insira o periodo de tempo final&quot;);</span>
<span class="nc" id="L803">        Viewer.prints(&quot;Ano:&quot;);</span>
<span class="nc" id="L804">        int anoF = Input.lerInt();</span>
<span class="nc" id="L805">        Viewer.prints(&quot;Dia:&quot;);</span>
<span class="nc" id="L806">        int diaF = Input.lerInt();</span>
<span class="nc" id="L807">        Viewer.prints(&quot;Mes:&quot;);</span>
<span class="nc" id="L808">        int mesF = Input.lerInt();</span>
<span class="nc" id="L809">        Viewer.prints(&quot;Horas:&quot;);</span>
<span class="nc" id="L810">        int horasF = Input.lerInt();</span>
<span class="nc" id="L811">        Viewer.prints(&quot;Minuto:&quot;);</span>
<span class="nc" id="L812">        int minF = Input.lerInt();</span>

<span class="nc" id="L814">        LocalDateTime di = null;</span>
<span class="nc" id="L815">        LocalDateTime df = null;</span>

        try {
<span class="nc" id="L818">            di = LocalDateTime.of(anoI, mesI, diaI, horasI, minI);</span>
<span class="nc" id="L819">            df = LocalDateTime.of(anoF, mesF, diaF, horasF, minF);</span>
<span class="nc" id="L820">        } catch (DateTimeException e) {</span>
<span class="nc" id="L821">            Viewer.prints(&quot;Data: Erro&quot;);</span>
<span class="nc" id="L822">            factTempo(cod);</span>
<span class="nc" id="L823">        }</span>

<span class="nc" id="L825">        Viewer.prints(&quot;Faturacao total no periodo entre &quot; + di + &quot; e &quot; + df);</span>
<span class="nc" id="L826">        Viewer.prints(this.gestor.totalFact(cod, di, df));</span>

<span class="nc" id="L828">        Viewer.prints(&quot;\n0) Voltar ao menu.&quot;);</span>
        do {
<span class="nc" id="L830">            i = Input.lerInt();</span>
<span class="nc bnc" id="L831" title="All 2 branches missed.">        } while (i != 0);</span>
<span class="nc" id="L832">        menuEmpresa(cod);</span>
<span class="nc" id="L833">    }</span>

    /**
     * Método responsável por gravar o estado atual do programa
     *
     * @param name Nome do ficheiro onde vamos gravar o estado
     */
    //Gravar Estado
    public void writeEstado(String name) throws IOException {
<span class="nc" id="L842">        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(name))) {</span>
<span class="nc" id="L843">            oos.writeObject(this.gestor);</span>
<span class="nc" id="L844">            oos.flush();</span>
        }
<span class="nc" id="L846">    }</span>

    /**
     * Método responsável por dar load do estado gravado
     *
     * @param name Nome do ficheiro em que foi gravado o estado
     */
    //Load Estado
    public Gestor loadEstado(String name) throws IOException, ClassNotFoundException {
        Gestor novo;
<span class="nc" id="L856">        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream(name))) {</span>
<span class="nc" id="L857">            novo = (Gestor) ois.readObject();</span>
        }
<span class="nc" id="L859">        return novo;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>